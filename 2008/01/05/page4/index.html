<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="字符串函数对二进制数据、字符串和表达式执行不同的运算。此类函数作用于CHAR、VARCHAR、 BINARY、 和VARBINARY 数据类型以及可以隐式转换为CHAR 或VARCHAR的数据类型。可以在SELECT 语句的SELECT 和WHERE 子句以及表达式中使用字符串函数。一、字符转换函数1、ASCII()返回字符表达式最左端字符的ASCII 码值。在ASCII（）函数中，纯数字的字符串">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL常用的几个函数---比较实用">
<meta property="og:url" content="https://wanghuaren.github.io/2008/01/05/page4/index.html">
<meta property="og:site_name" content="on my way">
<meta property="og:description" content="字符串函数对二进制数据、字符串和表达式执行不同的运算。此类函数作用于CHAR、VARCHAR、 BINARY、 和VARBINARY 数据类型以及可以隐式转换为CHAR 或VARCHAR的数据类型。可以在SELECT 语句的SELECT 和WHERE 子句以及表达式中使用字符串函数。一、字符转换函数1、ASCII()返回字符表达式最左端字符的ASCII 码值。在ASCII（）函数中，纯数字的字符串">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2008-01-05T02:46:17.000Z">
<meta property="article:modified_time" content="2024-03-18T16:56:56.000Z">
<meta property="article:author" content="wnghuaren">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>SQL常用的几个函数---比较实用</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/wanghuaren">项目</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2008/01/05/page5/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2007/02/15/page2/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanghuaren.github.io/2008/01/05/page4/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanghuaren.github.io/2008/01/05/page4/&text=SQL常用的几个函数---比较实用"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanghuaren.github.io/2008/01/05/page4/&is_video=false&description=SQL常用的几个函数---比较实用"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SQL常用的几个函数---比较实用&body=Check out this article: https://wanghuaren.github.io/2008/01/05/page4/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanghuaren.github.io/2008/01/05/page4/&name=SQL常用的几个函数---比较实用&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanghuaren.github.io/2008/01/05/page4/&t=SQL常用的几个函数---比较实用"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        SQL常用的几个函数---比较实用
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">wnghuaren</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2008-01-05T02:46:17.000Z" class="dt-published" itemprop="datePublished">2008-01-05</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>字符串函数对二进制数据、字符串和表达式执行不同的运算。此类函数作用于CHAR、VARCHAR、 BINARY、 和VARBINARY 数据类型以及可以隐式转换为CHAR 或VARCHAR的数据类型。可以在SELECT 语句的SELECT 和WHERE 子句以及表达式中使用字符串函数。<br>一、字符转换函数<br>1、ASCII()<br>返回字符表达式最左端字符的ASCII 码值。在ASCII（）函数中，纯数字的字符串可不用‘’括起来，但含其它字符的字符串必须用‘’括起来使用，否则会出错。<br>2、CHAR()<br>将ASCII 码转换为字符。如果没有输入0 ~ 255 之间的ASCII 码值，CHAR（） 返回NULL 。<br>3、LOWER()和UPPER()<br>LOWER()将字符串全部转为小写；UPPER()将字符串全部转为大写。<br>4、STR()<br>把数值型数据转换为字符型数据。<br>STR (<float_expression>[，length[， <decimal>]])<br>length 指定返回的字符串的长度，decimal 指定返回的小数位数。如果没有指定长度，缺省的length 值为10， decimal 缺省值为0。<br>当length 或者decimal 为负值时，返回NULL；<br>当length 小于小数点左边（包括符号位）的位数时，返回length 个*；<br>先服从length ，再取decimal ；<br>当返回的字符串位数小于length ，左边补足空格。<br>二、去空格函数<br>1、LTRIM() 把字符串头部的空格去掉。<br>2、RTRIM() 把字符串尾部的空格去掉。<br>三、取子串函数<br>1、left()<br>LEFT (<character_expression>， <integer_expression>)<br>返回character_expression 左起 integer_expression 个字符。<br>2、RIGHT()<br>RIGHT (<character_expression>， <integer_expression>)<br>返回character_expression 右起 integer_expression 个字符。<br>3、SUBSTRING()<br>SUBSTRING (<expression>， <starting_ position>， length)<br>返回从字符串左边第starting_ position 个字符起length个字符的部分。<br>四、字符串比较函数<br>1、CHARINDEX()<br>返回字符串中某个指定的子串出现的开始位置。<br>CHARINDEX (&lt;’substring_expression’&gt;， <expression>)<br>其中substring <em>expression 是所要查找的字符表达式，expression 可为字符串也可为列名表达式。如果没有发现子串，则返回0 值。<br>此函数不能用于TEXT 和IMAGE 数据类型。<br>2、PATINDEX()<br>返回字符串中某个指定的子串出现的开始位置。<br>PATINDEX (&lt;’%substring _expression%’&gt;， <column_ name>)其中子串表达式前后必须有百分号“%”否则返回值为0。<br>与CHARINDEX 函数不同的是，PATINDEX函数的子串中可以使用通配符，且此函数可用于CHAR、 VARCHAR 和TEXT 数据类型。<br>五、字符串操作函数<br>1、QUOTENAME()<br>返回被特定字符括起来的字符串。<br>QUOTENAME (&lt;’character_expression’&gt;[， quote</em> character]) 其中quote_ character 标明括字符串所用的字符，缺省值为“[]”。<br>2、REPLICATE()<br>返回一个重复character_expression 指定次数的字符串。<br>REPLICATE (character_expression integer_expression) 如果integer_expression 值为负值，则返回NULL 。<br>3、REVERSE()<br>将指定的字符串的字符排列顺序颠倒。<br>REVERSE (<character_expression>) 其中character_expression 可以是字符串、常数或一个列的值。<br>4、REPLACE()<br>返回被替换了指定子串的字符串。<br>REPLACE (<string_expression1>， <string_expression2>， <string_expression3>) 用string_expression3 替换在string_expression1 中的子串string_expression2。<br>4、SPACE()<br>返回一个有指定长度的空白字符串。<br>SPACE (<integer_expression>) 如果integer_expression 值为负值，则返回NULL 。<br>5、STUFF()<br>用另一子串替换字符串指定位置、长度的子串。<br>STUFF (<character_expression1>， <start_ position>， <length>，<character_expression2>)<br>如果起始位置为负或长度值为负，或者起始位置大于character_expression1 的长度，则返回NULL 值。<br>如果length 长度大于character_expression1 中 start_ position 以右的长度，则character_expression1 只保留首字符。<br>六、数据类型转换函数<br>1、CAST()<br>CAST (<expression> AS <data_ type>[ length ])<br>2、CONVERT()<br>CONVERT (<data_ type>[ length ]， <expression> [， style])<br>1）data_type为SQL Server系统定义的数据类型，用户自定义的数据类型不能在此使用。<br>2）length用于指定数据的长度，缺省值为30。<br>3）把CHAR或VARCHAR类型转换为诸如INT或SAMLLINT这样的INTEGER类型、结果必须是带正号或负号的数值。<br>4）TEXT类型到CHAR或VARCHAR类型转换最多为8000个字符，即CHAR或VARCHAR数据类型是最大长度。<br>5）IMAGE类型存储的数据转换到BINARY或VARBINARY类型，最多为8000个字符。<br>6）把整数值转换为MONEY或SMALLMONEY类型，按定义的国家的货币单位来处理，如人民币、美元、英镑等。<br>7）BIT类型的转换把非零值转换为1，并仍以BIT类型存储。<br>8）试图转换到不同长度的数据类型，会截短转换值并在转换值后显示“+”，以标识发生了这种截断。<br>9）用CONVERT（） 函数的style 选项能以不同的格式显示日期和时间。style 是将DATATIME 和SMALLDATETIME 数据转换为字符串时所选用的由SQL Server 系统提供的转换样式编号，不同的样式编号有不同的输出格式。<br>七、日期函数<br>1、day(date_expression)<br>返回date_expression中的日期值<br>2、month(date_expression)<br>返回date_expression中的月份值<br>3、year(date_expression)<br>返回date_expression中的年份值<br>4、DATEADD()<br>DATEADD (<datepart>， <number>， <date>)<br>返回指定日期date 加上指定的额外日期间隔number 产生的新日期。参数“datepart” 取值如下：<br>5、DATEDIFF()<br>DATEDIFF (<datepart>， <date1>， <date2>)<br>返回两个指定日期在datepart 方面的不同之处，即date2 超过date1的差距值，其结果值是一个带有正负号的整数值。<br>6、DATENAME()<br>DATENAME (<datepart>， <date>)<br>以字符串的形式返回日期的指定部分此部分。由datepart 来指定。<br>7、DATEPART()<br>DATEPART (<datepart>， <date>)<br>以整数值的形式返回日期的指定部分。此部分由datepart 来指定。<br>DATEPART (dd， date) 等同于DAY (date)<br>DATEPART (mm， date) 等同于MONTH (date)<br>DATEPART (yy， date) 等同于YEAR (date)<br>8、GETDATE()<br>以DATETIME 的缺省格式返回系统当前的日期和时间</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/wanghuaren">项目</a></li>
        
      </ul>
    </div>

    
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanghuaren.github.io/2008/01/05/page4/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanghuaren.github.io/2008/01/05/page4/&text=SQL常用的几个函数---比较实用"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanghuaren.github.io/2008/01/05/page4/&is_video=false&description=SQL常用的几个函数---比较实用"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SQL常用的几个函数---比较实用&body=Check out this article: https://wanghuaren.github.io/2008/01/05/page4/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanghuaren.github.io/2008/01/05/page4/&title=SQL常用的几个函数---比较实用"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanghuaren.github.io/2008/01/05/page4/&name=SQL常用的几个函数---比较实用&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanghuaren.github.io/2008/01/05/page4/&t=SQL常用的几个函数---比较实用"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    wnghuaren
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/wanghuaren">项目</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
