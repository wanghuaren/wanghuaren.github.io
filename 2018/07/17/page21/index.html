<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Insert Documents insertOne(), insertMany() returns a document that includes the newly inserted documents _id field values. Behavior  If the collection does not currently exist, insert operations will">
<meta property="og:type" content="article">
<meta property="og:title" content="MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查">
<meta property="og:url" content="https://wanghuaren.github.io/2018/07/17/page21/index.html">
<meta property="og:site_name" content="on my way">
<meta property="og:description" content="Insert Documents insertOne(), insertMany() returns a document that includes the newly inserted documents _id field values. Behavior  If the collection does not currently exist, insert operations will">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-07-17T07:37:22.000Z">
<meta property="article:modified_time" content="2024-01-08T10:10:23.903Z">
<meta property="article:author" content="wnghuaren">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2018/10/22/page22/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2017/12/09/page20/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanghuaren.github.io/2018/07/17/page21/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanghuaren.github.io/2018/07/17/page21/&text=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanghuaren.github.io/2018/07/17/page21/&is_video=false&description=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查&body=Check out this article: https://wanghuaren.github.io/2018/07/17/page21/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanghuaren.github.io/2018/07/17/page21/&name=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanghuaren.github.io/2018/07/17/page21/&t=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">wnghuaren</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2018-07-17T07:37:22.000Z" class="dt-published" itemprop="datePublished">2018-07-17</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>Insert Documents</p>
<p>insertOne(), insertMany() returns a document that includes the newly inserted documents _id field values.</p>
<p>Behavior</p>
<ol>
<li><p>If the collection does not currently exist, insert operations will create the collection.</p>
</li>
<li><p>In MongoDB, each document stored in a collection requires a unique _id field that acts as a primary key. If an inserted document omits the _id field, the MongoDB driver automatically generates an ObjectId for the _id field. This also applies to documents inserted through update operations with upsert: true.</p>
</li>
<li><p>All write operations in MongoDB are atomic on the level of a single document.</p>
</li>
</ol>
<p>Query Documents</p>
<p>Select All Documents in a Collection</p>
<pre><code>db.inventory.find( &#123;&#125; )
SELECT * FROM inventory
</code></pre>
<p>Specify Equality Condition</p>
<pre><code>&#123; &lt;field1&gt;: &lt;value1&gt;, ... &#125;
db.inventory.find( &#123; status: &quot;D&quot; &#125; )
SELECT * FROM inventory WHERE status = &quot;D&quot;
</code></pre>
<p>Specify Conditions Using Query Operators</p>
<pre><code>&#123; &lt;field1&gt;: &#123; &lt;operator1&gt;: &lt;value1&gt; &#125;, ... &#125;
db.inventory.find( &#123; status: &#123; $in: [ &quot;A&quot;, &quot;D&quot; ] &#125; &#125; )
SELECT * FROM inventory WHERE status in (&quot;A&quot;, &quot;D&quot;)
</code></pre>
<p>NOTE: Although you can express this query using the $or operator, use the $in operator rather than the $or operator when performing equality checks on the same field.</p>
<p>Specify AND Conditions</p>
<p>A compound query can specify conditions for more than one field in the collection’s documents. Implicitly, a logical AND conjunction connects the clauses of a compound query so that the query selects the documents in the collection that match all the conditions.</p>
<pre><code>db.inventory.find( &#123; status: &quot;A&quot;, qty: &#123; $lt: 30 &#125; &#125; )
SELECT * FROM inventory WHERE status = &quot;A&quot; AND qty &lt; 30
</code></pre>
<p>Specify OR Conditions</p>
<p>Using the $or operator, you can specify a compound query that joins each clause with a logical OR conjunction so that the query selects the documents in the collection that match at least one condition.</p>
<pre><code>db.inventory.find( &#123; $or: [ &#123; status: &quot;A&quot; &#125;, &#123; qty: &#123; $lt: 30 &#125; &#125; ] &#125; )
SELECT * FROM inventory WHERE status = &quot;A&quot; OR qty &lt; 30
</code></pre>
<p>Specify AND as well as OR Conditions</p>
<pre><code>db.inventory.find( &#123;
    status: &quot;A&quot;,
    $or: [ &#123; qty: &#123; $lt: 30 &#125; &#125;, &#123; item: /^p/ &#125; ]
&#125; )
SELECT * FROM inventory WHERE status = &quot;A&quot; AND ( qty &lt; 30 OR item LIKE &quot;p%&quot;)
</code></pre>
<p>NOTE: MongoDB supports regular expressions $regex queries to perform string pattern matches.</p>
<p>Query on Embedded&#x2F;Nested Documents</p>
<p>Match an Embedded&#x2F;Nested Document</p>
<p>To specify an equality condition on a field that is an embedded&#x2F;nested document, use the query filter document { : } where is the document to match.</p>
<pre><code>db.inventory.find( &#123; size: &#123; h: 14, w: 21, uom: &quot;cm&quot; &#125; &#125; )
</code></pre>
<p>NOTE: Equality matches on the whole embedded document require an exact match of the specified document, including the field order.</p>
<p>Query on Nested Field</p>
<p>To specify a query condition on fields in an embedded&#x2F;nested document, use dot notation (“field.nestedField”).</p>
<p>NOTE: When querying using dot notation, the field and nested field must be inside quotation marks.</p>
<p>Specify Equality Match on a Nested Field</p>
<pre><code>db.inventory.find( &#123; &quot;size.uom&quot;: &quot;in&quot; &#125; )
</code></pre>
<p>Specify Match using Query Operator</p>
<pre><code>&#123; &lt;field1&gt;: &#123; &lt;operator1&gt;: &lt;value1&gt; &#125;, ... &#125;
db.inventory.find( &#123; &quot;size.h&quot;: &#123; $lt: 15 &#125; &#125; )
</code></pre>
<p>Specify AND Condition</p>
<pre><code>db.inventory.find( &#123; &quot;size.h&quot;: &#123; $lt: 15 &#125;, &quot;size.uom&quot;: &quot;in&quot;, status: &quot;D&quot; &#125; )
</code></pre>
<p>Query an Array</p>
<p>Match an Array</p>
<p>To specify equality condition on an array, use the query document { : } where is the exact array to match, including the order of the elements.</p>
<pre><code>db.inventory.find( &#123; tags: [&quot;red&quot;, &quot;blank&quot;] &#125; )
</code></pre>
<p>If, instead, you wish to find an array that contains both the elements “red” and “blank”, without regard to order or other elements in the array, use the $all operator:</p>
<pre><code>db.inventory.find( &#123; tags: &#123; $all: [&quot;red&quot;, &quot;blank&quot;] &#125; &#125; )
</code></pre>
<p>Query an Array for an Element</p>
<p>To query if the array field contains at least one element with the specified value, use the filter { : } where is the element value.</p>
<pre><code>db.inventory.find( &#123; tags: &quot;red&quot; &#125; )
</code></pre>
<p>To specify conditions on the elements in the array field</p>
<pre><code>&#123; &lt;array field&gt;: &#123; &lt;operator1&gt;: &lt;value1&gt;, ... &#125; &#125;
db.inventory.find( &#123; dim_cm: &#123; $gt: 25 &#125; &#125; )
</code></pre>
<p>Specify Multiple Conditions for Array Elements</p>
<p>When specifying compound conditions on array elements, you can specify the query such that either a single array element meets these condition or any combination of array elements meets the conditions.</p>
<p>Query an Array with Compound Filter Conditions on the Array Elements</p>
<pre><code>db.inventory.find( &#123; dim_cm: &#123; $gt: 15, $lt: 20 &#125; &#125; )
</code></pre>
<p>Query for an Array Element that Meets Multiple Criteria</p>
<p>Use $elemMatch operator to specify multiple criteria on the elements of an array such that at least one array element satisfies all the specified criteria.</p>
<pre><code>db.inventory.find( &#123; dim_cm: &#123; $elemMatch: &#123; $gt: 22, $lt: 30 &#125; &#125; &#125; )
</code></pre>
<p>Query for an Element by the Array Index Position</p>
<p>Using dot notation, you can specify query conditions for an element at a particular index or position of the array. The array uses zero-based indexing.</p>
<pre><code>db.inventory.find( &#123; &quot;dim_cm.1&quot;: &#123; $gt: 25 &#125; &#125; )
</code></pre>
<p>Query an Array by Array Length</p>
<p>Use the $size operator to query for arrays by number of elements.</p>
<pre><code>db.inventory.find( &#123; &quot;tags&quot;: &#123; $size: 3 &#125; &#125; )
</code></pre>
<p>Query an Array of Embedded Documents</p>
<p>Query for a Document Nested in an Array</p>
<pre><code>db.inventory.find( &#123; &quot;instock&quot;: &#123; warehouse: &quot;A&quot;, qty: 5 &#125; &#125; )
</code></pre>
<p>NOTE: Equality matches on the whole embedded&#x2F;nested document require an exact match of the specified document, including the field order.</p>
<p>Specify a Query Condition on a Field in an Array of Documents</p>
<p>Specify a Query Condition on a Field Embedded in an Array of Documents</p>
<p>If you do not know the index position of the document nested in the array, concatenate the name of the array field, with a dot (.) and the name of the field in the nested document.</p>
<pre><code>db.inventory.find( &#123; &#39;instock.qty&#39;: &#123; $lte: 20 &#125; &#125; )
</code></pre>
<p>Use the Array Index to Query for a Field in the Embedded Document</p>
<p>Using dot notation, you can specify query conditions for field in a document at a particular index or position of the array. The array uses zero-based indexing.</p>
<pre><code>db.inventory.find( &#123; &#39;instock.0.qty&#39;: &#123; $lte: 20 &#125; &#125; )
</code></pre>
<p>NOTE: When querying using dot notation, the field and index must be inside quotation marks.</p>
<p>Specify Multiple Conditions for Array of Documents</p>
<p>When specifying conditions on more than one field nested in an array of documents, you can specify the query such that either a single document meets these condition or any combination of documents (including a single document) in the array meets the conditions.</p>
<p>A Single Nested Document Meets Multiple Query Conditions on Nested Fields</p>
<p>Use $elemMatch operator to specify multiple criteria on an array of embedded documents such that at least one embedded document satisfies all the specified criteria.</p>
<pre><code>db.inventory.find( &#123; &quot;instock&quot;: &#123; $elemMatch: &#123; qty: 5, warehouse: &quot;A&quot; &#125; &#125; &#125; )
db.inventory.find( &#123; &quot;instock&quot;: &#123; $elemMatch: &#123; qty: &#123; $gt: 10, $lte: 20 &#125; &#125; &#125; &#125; )
</code></pre>
<p>Combination of Elements Satisfies the Criteria</p>
<p>If the compound query conditions on an array field do not use the $elemMatch operator, the query selects those documents whose array contains any combination of elements that satisfies the conditions.</p>
<pre><code>db.inventory.find( &#123; &quot;instock.qty&quot;: &#123; $gt: 10,  $lte: 20 &#125; &#125; )
db.inventory.find( &#123; &quot;instock.qty&quot;: 5, &quot;instock.warehouse&quot;: &quot;A&quot; &#125; )
</code></pre>
<p>Project Fields to Return from Query</p>
<p>By default, queries in MongoDB return all fields in matching documents. To limit the amount of data that MongoDB sends to applications, you can include a projection document to specify or restrict fields to return.</p>
<p>Return All Fields in Matching Documents</p>
<p>If you do not specify a projection document, the db.collection.find() method returns all fields in the matching documents.</p>
<pre><code>db.inventory.find( &#123; status: &quot;A&quot; &#125; )
SELECT * from inventory WHERE status = &quot;A&quot;
</code></pre>
<p>Return the Specified Fields and the _id Field Only</p>
<p>A projection can explicitly include several fields by setting the to 1 in the projection document.</p>
<pre><code>db.inventory.find( &#123; status: &quot;A&quot; &#125;, &#123; item: 1, status: 1 &#125; )
SELECT _id, item, status from inventory WHERE status = &quot;A&quot;
</code></pre>
<p>Suppress _id Field</p>
<p>You can remove the _id field from the results by setting its exclusion to 0 in the projection</p>
<pre><code>db.inventory.find( &#123; status: &quot;A&quot; &#125;, &#123; item: 1, status: 1, _id: 0 &#125; )
SELECT item, status from inventory WHERE status = &quot;A&quot;
</code></pre>
<p>Return All But the Excluded Fields</p>
<p>Instead of listing the fields to return in the matching document, you can use a projection to exclude specific fields.</p>
<pre><code>db.inventory.find( &#123; status: &quot;A&quot; &#125;, &#123; status: 0, instock: 0 &#125; )
</code></pre>
<p>NOTE: With the exception of the _id field, you cannot combine inclusion and exclusion statements in projection documents.</p>
<p>Return Specific Fields in Embedded Documents</p>
<p>You can return specific fields in an embedded document. Use the dot notation to refer to the embedded field and set to 1 in the projection document.</p>
<pre><code>db.inventory.find(
&#123; status: &quot;A&quot; &#125;,
&#123; item: 1, status: 1, &quot;size.uom&quot;: 1 &#125;
)
</code></pre>
<p>Suppress Specific Fields in Embedded Documents</p>
<p>You can suppress specific fields in an embedded document. Use the dot notation to refer to the embedded field in the projection document and set to 0.</p>
<pre><code>db.inventory.find(
&#123; status: &quot;A&quot; &#125;,
&#123; &quot;size.uom&quot;: 0 &#125;
)
</code></pre>
<p>Projection on Embedded Documents in an Array</p>
<p>Use dot notation to project specific fields inside documents embedded in an array.</p>
<pre><code>db.inventory.find( &#123; status: &quot;A&quot; &#125;, &#123; item: 1, status: 1, &quot;instock.qty&quot;: 1 &#125; )
</code></pre>
<p>Project Specific Array Elements in the Returned Array</p>
<p>For fields that contain arrays, MongoDB provides the following projection operators for manipulating arrays: $elemMatch, $slice, and $.</p>
<p>$elemMatch, $slice, and $ are the only way to project specific elements to include in the returned array. For instance, you cannot project specific array elements using the array index; e.g. { “instock.0”: 1 } projection will not project the array with the first element.</p>
<pre><code>db.inventory.find( &#123; status: &quot;A&quot; &#125;, &#123; item: 1, status: 1, instock: &#123; $slice: -1 &#125; &#125; )
</code></pre>
<p>Query for Null or Missing Fields</p>
<p>Different query operators in MongoDB treat null values differently.</p>
<p>Equality Filter</p>
<p>The { item : null } query matches documents that either contain the item field whose value is null or that do not contain the item field.</p>
<pre><code>db.inventory.find( &#123; item: null &#125; )
</code></pre>
<p>Type Check</p>
<p>The { item : { $type: 10 } } query matches only documents that contain the item field whose value is null</p>
<pre><code>db.inventory.find( &#123; item : &#123; $type: 10 &#125; &#125; )
</code></pre>
<p>Existence Check</p>
<p>The { item : { $exists: false } } query matches documents that do not contain the item field:</p>
<pre><code>db.inventory.find( &#123; item : &#123; $exists: false &#125; &#125; )
</code></pre>
<p>Iterate a Cursor in the mongo Shell</p>
<p>The db.collection.find() method returns a cursor. To access the documents, you need to iterate the cursor. However, in the mongo shell, if the returned cursor is not assigned to a variable using the var keyword, then the cursor is automatically iterated up to 20 times [1] to print up to the first 20 documents in the results.</p>
<p>Manually Iterate the Cursor</p>
<p>In the mongo shell, when you assign the cursor returned from the find() method to a variable using the var keyword, the cursor does not automatically iterate.</p>
<p>You can call the cursor variable in the shell to iterate up to 20 times [1] and print the matching documents</p>
<pre><code>var myCursor = db.users.find( &#123; type: 2 &#125; );

myCursor
</code></pre>
<p>You can also use the cursor method next() to access the documents</p>
<pre><code>var myCursor = db.users.find( &#123; type: 2 &#125; );

while (myCursor.hasNext()) &#123;
print(tojson(myCursor.next()));
&#125;
</code></pre>
<p>As an alternative print operation, consider the printjson() helper method to replace print(tojson())</p>
<pre><code>var myCursor = db.users.find( &#123; type: 2 &#125; );

while (myCursor.hasNext()) &#123;
printjson(myCursor.next());
&#125;
</code></pre>
<p>You can use the cursor method forEach() to iterate the cursor and access the documents</p>
<pre><code>var myCursor =  db.users.find( &#123; type: 2 &#125; );

myCursor.forEach(printjson);
</code></pre>
<p>NOTE: You can use the DBQuery.shellBatchSize to change the number of iteration from the default value 20.</p>
<p>Iterator Index</p>
<p>In the mongo shell, you can use the toArray() method to iterate the cursor and return the documents in an array, as in the following:</p>
<pre><code>var myCursor = db.inventory.find( &#123; type: 2 &#125; );
var documentArray = myCursor.toArray();
var myDocument = documentArray[3];
</code></pre>
<p>The toArray() method loads into RAM all documents returned by the cursor; the toArray() method exhausts the cursor.</p>
<p>Additionally, some drivers provide access to the documents by using an index on the cursor (i.e. cursor[index]). This is a shortcut for first calling the toArray() method and then using an index on the resulting array.</p>
<pre><code>var myCursor = db.users.find( &#123; type: 2 &#125; );
var myDocument = myCursor[1];
</code></pre>
<p>Cursor Behaviors</p>
<p>Cursor Information</p>
<p>Update Documents</p>
<p>db.collection.updateOne(, , ) db.collection.updateMany(, , ) db.collection.replaceOne(, , )</p>
<p>Update Documents in a Collection</p>
<p>To update a document, MongoDB provides update operators, such as $set, to modify field values.</p>
<pre><code>&#123;
&lt;update operator&gt;: &#123; &lt;field1&gt;: &lt;value1&gt;, ... &#125;,
&lt;update operator&gt;: &#123; &lt;field2&gt;: &lt;value2&gt;, ... &#125;,
...
&#125;
</code></pre>
<p>Update a Single Document</p>
<pre><code>db.inventory.updateOne(
&#123; item: &quot;paper&quot; &#125;,
&#123;
    $set: &#123; &quot;size.uom&quot;: &quot;cm&quot;, status: &quot;P&quot; &#125;,
    $currentDate: &#123; lastModified: true &#125;
&#125;
)
</code></pre>
<p>Update Multiple Documents</p>
<pre><code>db.inventory.updateMany(
&#123; &quot;qty&quot;: &#123; $lt: 50 &#125; &#125;,
&#123;
    $set: &#123; &quot;size.uom&quot;: &quot;in&quot;, status: &quot;P&quot; &#125;,
    $currentDate: &#123; lastModified: true &#125;
&#125;
)
</code></pre>
<p>Replace a Document</p>
<p>To replace the entire content of a document except for the _id field, pass an entirely new document as the second argument to db.collection.replaceOne().</p>
<p>When replacing a document, the replacement document must consist of only field&#x2F;value pairs; i.e. do not include update operators expressions.</p>
<p>The replacement document can have different fields from the original document. In the replacement document, you can omit the _id field since the _id field is immutable; however, if you do include the _id field, it must have the same value as the current value.</p>
<pre><code>db.inventory.replaceOne(
&#123; item: &quot;paper&quot; &#125;,
&#123; item: &quot;paper&quot;, instock: [ &#123; warehouse: &quot;A&quot;, qty: 60 &#125;, &#123; warehouse: &quot;B&quot;, qty: 40 &#125; ] &#125;
)
</code></pre>
<p>Behavior</p>
<ol>
<li><p>All write operations in MongoDB are atomic on the level of a single document.</p>
</li>
<li><p>Once set, you cannot update the value of the _id field nor can you replace an existing document with a replacement document that has a different _id field value.</p>
</li>
<li><p>When performing update operations that increase the document size beyond the allocated space for that document, the update operation relocates the document on disk.</p>
</li>
<li><p>MongoDB preserves the order of the document fields following write operations except for the following cases: The _id field is always the first field in the document. Updates that include renaming of field names may result in the reordering of fields in the document.</p>
</li>
</ol>
<p>Upsert Option</p>
<p>If updateOne(), updateMany(), or replaceOne() includes upsert : true and no documents match the specified filter, then the operation creates a new document and inserts it. If there are matching documents, then the operation modifies or replaces the matching document or documents.</p>
<p>Delete Documents</p>
<p>Delete All Documents</p>
<p>To delete all documents from a collection, pass an empty filter document {} to the db.collection.deleteMany() method.</p>
<pre><code>db.inventory.deleteMany(&#123;&#125;)
</code></pre>
<p>Delete All Documents that Match a Condition</p>
<p>You can specify criteria, or filters, that identify the documents to delete. The filters use the same syntax as read operations.</p>
<p>To delete all documents that match a deletion criteria, pass a filter parameter to the deleteMany() method.</p>
<pre><code>&#123; &lt;field1&gt;: &lt;value1&gt;, ... &#125;
&#123; &lt;field1&gt;: &#123; &lt;operator1&gt;: &lt;value1&gt; &#125;, ... &#125;
db.inventory.deleteMany(&#123; status : &quot;A&quot; &#125;)
</code></pre>
<p>Delete Only One Document that Matches a Condition</p>
<p>To delete at most a single document that matches a specified filter (even though multiple documents may match the specified filter) use the db.collection.deleteOne() method.</p>
<pre><code>db.inventory.deleteOne( &#123; status: &quot;D&quot; &#125; )
</code></pre>
<p>Behavior</p>
<ol>
<li><p>Delete operations do not drop indexes, even if deleting all documents from a collection.</p>
</li>
<li><p>All write operations in MongoDB are atomic on the level of a single document.</p>
</li>
</ol>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li>
        
      </ul>
    </div>

    
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanghuaren.github.io/2018/07/17/page21/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanghuaren.github.io/2018/07/17/page21/&text=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanghuaren.github.io/2018/07/17/page21/&is_video=false&description=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查&body=Check out this article: https://wanghuaren.github.io/2018/07/17/page21/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanghuaren.github.io/2018/07/17/page21/&title=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanghuaren.github.io/2018/07/17/page21/&name=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanghuaren.github.io/2018/07/17/page21/&t=MongoDB Manual 3.6 The mongo Shell CRUD operations create, read, update, and delete documents（增删改查"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    wnghuaren
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
